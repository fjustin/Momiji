!function(){function e(){}function t(e){this.buttonBar=f.getElementById("wmd-button-bar"+e),this.preview=f.getElementById("wmd-preview"+e),this.input=f.getElementById("wmd-input"+e)}function n(e,t){var n,i,o,a=this,s=[],c=0,d="none",f=function(e,t){d!=e&&(d=e,t||p()),g.isIE&&"moving"==d?o=null:i=setTimeout(u,1)},u=function(e){o=new r(t,e),i=undefined};this.setCommandMode=function(){d="command",p(),i=setTimeout(u,0)},this.canUndo=function(){return c>1},this.canRedo=function(){return!!s[c+1]},this.undo=function(){a.canUndo()&&(n?(n.restore(),n=null):(s[c]=new r(t),s[--c].restore(),e&&e())),d="none",t.input.focus(),u()},this.redo=function(){a.canRedo()&&(s[++c].restore(),e&&e()),d="none",t.input.focus(),u()};var p=function(){var i=o||new r(t);if(!i)return!1;"moving"!=d?(n&&(s[c-1].text!=n.text&&(s[c++]=n),n=null),s[c++]=i,s[c+1]=null,e&&e()):n||(n=i)},h=function(e){var t=!1;if(e.ctrlKey||e.metaKey){var n=e.charCode||e.keyCode;switch(String.fromCharCode(n)){case"y":a.redo(),t=!0;break;case"z":e.shiftKey?a.redo():a.undo(),t=!0}}t&&(e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1))},m=function(e){if(!e.ctrlKey&&!e.metaKey){var t=e.keyCode;t>=33&&t<=40||t>=63232&&t<=63235?f("moving"):8==t||46==t||127==t?f("deleting"):13==t?f("newlines"):27==t?f("escape"):(t<16||t>20)&&91!=t&&f("typing")}},v=function(){l.addEvent(t.input,"keypress",function(e){!e.ctrlKey&&!e.metaKey||89!=e.keyCode&&90!=e.keyCode||e.preventDefault()});var e=function(){(g.isIE||o&&o.text!=t.input.value)&&i==undefined&&(d="paste",p(),u())};l.addEvent(t.input,"keydown",h),l.addEvent(t.input,"keydown",m),l.addEvent(t.input,"mousedown",function(){f("moving")}),t.input.onpaste=e,t.input.ondrop=e};(function(){v(),u(!0),p()})()}function r(t,n){var r=this,i=t.input;this.init=function(){l.isVisible(i)&&(!n&&f.activeElement&&f.activeElement!==i||(this.setInputAreaSelectionStartEnd(),this.scrollTop=i.scrollTop,(!this.text&&i.selectionStart||0===i.selectionStart)&&(this.text=i.value)))},this.setInputAreaSelection=function(){if(l.isVisible(i))if(i.selectionStart===undefined||g.isOpera){if(f.selection){if(f.activeElement&&f.activeElement!==i)return;i.focus();var e=i.createTextRange();e.moveStart("character",-i.value.length),e.moveEnd("character",-i.value.length),e.moveEnd("character",r.end),e.moveStart("character",r.start),e.select()}}else i.focus(),i.selectionStart=r.start,i.selectionEnd=r.end,i.scrollTop=r.scrollTop},this.setInputAreaSelectionStartEnd=function(){if(t.ieCachedRange||!i.selectionStart&&0!==i.selectionStart){if(f.selection){r.text=l.fixEolChars(i.value);var e=t.ieCachedRange||f.selection.createRange(),n=l.fixEolChars(e.text),o="\x07",a=o+n+o;e.text=a;var s=l.fixEolChars(i.value);e.moveStart("character",-a.length),e.text=n,r.start=s.indexOf(o),r.end=s.lastIndexOf(o)-o.length;var c=r.text.length-l.fixEolChars(i.value).length;if(c){for(e.moveStart("character",-n.length);c--;)n+="\n",r.end+=1;e.text=n}t.ieCachedRange&&(r.scrollTop=t.ieCachedScrollTop),t.ieCachedRange=null,this.setInputAreaSelection()}}else r.start=i.selectionStart,r.end=i.selectionEnd},this.restore=function(){r.text!=undefined&&r.text!=i.value&&(i.value=r.text),this.setInputAreaSelection(),i.scrollTop=r.scrollTop},this.getChunks=function(){var t=new e;return t.before=l.fixEolChars(r.text.substring(0,r.start)),t.startTag="",t.selection=l.fixEolChars(r.text.substring(r.start,r.end)),t.endTag="",t.after=l.fixEolChars(r.text.substring(r.end)),t.scrollTop=r.scrollTop,t},this.setChunks=function(e){e.before=e.before+e.startTag,e.after=e.endTag+e.after,this.start=e.before.length,this.end=e.before.length+e.selection.length,this.text=e.before+e.selection+e.after,this.scrollTop=e.scrollTop},this.init()}function i(e,t,n){var r,i,o,a=3e3,s="delayed",d=function(e,t){l.addEvent(e,"input",t),e.onpaste=t,e.ondrop=t,l.addEvent(e,"keypress",t),l.addEvent(e,"keydown",t)},u=function(){var e=0;return window.innerHeight?e=window.pageYOffset:f.documentElement&&f.documentElement.scrollTop?e=f.documentElement.scrollTop:f.body&&(e=f.body.scrollTop),e},p=function(){if(t.preview){var n=t.input.value;if(!n||n!=o){o=n;var r=(new Date).getTime();n=e.makeHtml(n);var a=(new Date).getTime();i=a-r,E(n)}}},h=function(){if(r&&(clearTimeout(r),r=undefined),"manual"!==s){var e=0;"delayed"===s&&(e=i),e>a&&(e=a),r=setTimeout(p,e)}},m=function(e){return e.scrollHeight<=e.clientHeight?1:e.scrollTop/(e.scrollHeight-e.clientHeight)},v=function(){t.preview&&(t.preview.scrollTop=(t.preview.scrollHeight-t.preview.clientHeight)*m(t.preview))};this.refresh=function(e){e?(o="",p()):h()},this.processingTime=function(){return i};var b,T=!0,w=function(e){var n=t.preview,r=n.parentNode,i=n.nextSibling;r.removeChild(n),n.innerHTML=e,i?r.insertBefore(n,i):r.appendChild(n)},C=function(e){t.preview.innerHTML=e},k=function(e){if(b)return b(e);try{C(e),b=C}catch(t){(b=w)(e)}},E=function(e){var r=c.getTop(t.input)-u();if(t.preview&&(k(e),n()),v(),T)T=!1;else{var i=c.getTop(t.input)-u();g.isIE?setTimeout(function(){window.scrollBy(0,i-r)},0):window.scrollBy(0,i-r)}};(function(){d(t.input,h),p(),t.preview&&(t.preview.scrollTop=0)})()}function o(e,t,n,i,o,a){function s(e){if(h.focus(),e.textOp){n&&n.setCommandMode();var o=new r(t);if(!o)return;var a=o.getChunks(),s=function(){h.focus(),a&&o.setChunks(a),o.restore(),i.refresh()};e.textOp(a,s)||s()}e.execute&&e.execute(n)}function c(e,t){t?(e.disabled=!1,e.isHelp||(e.onclick=function(){return this.onmouseout&&this.onmouseout(),s(this),!1})):e.disabled=!0}function d(e){return"string"==typeof e&&(e=o[e]),function(){e.apply(o,arguments)}}function f(){var n=t.buttonBar,r=document.createElement("div");r.id="wmd-button-row"+e,r.className="btn-toolbar",r=n.appendChild(r);var i=function(t,n,i,o,a){var s=document.createElement("button");s.className="btn btn-default btn-sm";var l=document.createElement("i");return l.className=i,s.appendChild(l),s.id=t+e,s.title=n,o&&(s.textOp=o),c(s,!0),a?a.appendChild(s):r.appendChild(s),s},o=function(t){var n=document.createElement("div");return n.className="btn-group wmd-button-group"+t,n.id="wmd-button-group"+t+e,r.appendChild(n),n},s=o(1);m.bold=i("wmd-bold-button","Bold (Ctrl+B)","fa fa-bold",d("doBold"),s),m.italic=i("wmd-italic-button","Italic (Ctrl+I)","fa fa-italic",d("doItalic"),s);var l=o(2);m.link=i("wmd-link-button","Link (Ctrl+L)","fa fa-link",d(function(e,t){return this.doLinkOrImage(e,t,!1)}),l),m.image=i("wmd-image-button","Image (Ctrl+G)","fa fa-picture-o",d(function(e,t){return this.doLinkOrImage(e,t,!0)}),l),m.quote=i("wmd-quote-button","Blockquote (Ctrl+Q)","fa fa-quote-left",d("doBlockquote"),l),m.code=i("wmd-code-button","Code Sample (Ctrl+K)","fa fa-code",d("doCode"),l);var f=o(3);m.ulist=i("wmd-ulist-button","Bulleted List (Ctrl+U)","fa fa-list-ul",d(function(e,t){this.doList(e,t,!1)}),f),m.olist=i("wmd-olist-button","Numbered List (Ctrl+O)","fa fa-list-ol",d(function(e,t){this.doList(e,t,!0)}),f),m.heading=i("wmd-heading-button","Heading (Ctrl+H)","fa fa-font",d("doHeading"),f);var h=o(4);m.undo=i("wmd-undo-button","Undo (Ctrl+Z)","fa fa-undo",null,h),m.undo.execute=function(e){e&&e.undo()};var g=/win/.test(p.platform.toLowerCase())?"Redo (Ctrl+Y)":"Redo (Ctrl+Shift+Z)";if(m.redo=i("wmd-redo-button",g,"fa fa-repeat",null,h),m.redo.execute=function(e){e&&e.redo()},a){var v=o(5);v.className=v.className+" pull-right";var b=document.createElement("button"),T=document.createElement("i");T.className="fa fa-info",b.appendChild(T),b.className="btn btn-info btn-sm",b.id="wmd-help-button"+e,b.isHelp=!0,b.title=a.title||y,b.onclick=a.handler,c(b,!0),v.appendChild(b),m.help=b}u()}function u(){n&&(c(m.undo,n.canUndo()),c(m.redo,n.canRedo()))}var h=t.input,m={};f();var v="keydown";g.isOpera&&(v="keypress"),l.addEvent(h,v,function(e){if((e.ctrlKey||e.metaKey)&&!e.altKey&&!e.shiftKey){var t=e.charCode||e.keyCode;switch(String.fromCharCode(t).toLowerCase()){case"b":s(m.bold);break;case"i":s(m.italic);break;case"l":s(m.link);break;case"q":s(m.quote);break;case"k":s(m.code);break;case"g":s(m.image);break;case"o":s(m.olist);break;case"u":s(m.ulist);break;case"h":s(m.heading);break;case"r":s(m.hr);break;case"y":s(m.redo);break;case"z":e.shiftKey?s(m.redo):s(m.undo);break;default:return}e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1)}}),l.addEvent(h,"keyup",function(e){if(e.shiftKey&&!e.ctrlKey&&!e.metaKey&&13===(e.charCode||e.keyCode)){var t={};t.textOp=d("doAutoindent"),s(t)}}),g.isIE&&l.addEvent(h,"keydown",function(e){if(27===e.keyCode)return!1}),this.setUndoRedoButtonStates=u}function a(e){this.hooks=e}function s(e){return e.replace(/^\s*(.*?)(?:\s+"(.+)")?\s*$/,function(e,t,n){return t=t.replace(/\?.*$/,function(e){return e.replace(/\+/g," ")}),t=decodeURIComponent(t),t=(t=encodeURI(t).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")).replace(/\?.*$/,function(e){return e.replace(/\+/g,"%2b")}),n&&(n=n.trim?n.trim():n.replace(/^\s*/,"").replace(/\s*$/,""),n=$.trim(n).replace(/"/g,"quot;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),n?t+' "'+n+'"':t})}var l={},c={},d={},f=window.document,u=window.RegExp,p=window.navigator,h={lineLength:72},g={isIE:/msie/.test(p.userAgent.toLowerCase()),isIE_5or6:/msie 6/.test(p.userAgent.toLowerCase())||/msie 5/.test(p.userAgent.toLowerCase()),isOpera:/opera/.test(p.userAgent.toLowerCase())},m="Insert link",v="Link URL",b='http://example.com/ "optional title"',T="Enter URL to point link to and optional title to display when mouse is placed over the link",w="Insert image",C="Image URL",k='http://example.com/images/diagram.jpg "optional title"',E="Enter URL where image is located and optional title to display when mouse is placed over the image",y="Markdown Editing Help";Markdown.Editor=function(e,r,s){r=r||"";var l=this.hooks=new Markdown.HookCollection;l.addNoop("onPreviewRefresh"),l.addNoop("postBlockquoteCreation"),l.addFalse("insertImageDialog"),this.getConverter=function(){return e};var c,d=this;this.run=function(){if(!c){c=new t(r);var u,p,h=new a(l),g=new i(e,c,function(){l.onPreviewRefresh()});/\?noundo/.test(f.location.href)||(u=new n(function(){g.refresh(),p&&p.setUndoRedoButtonStates()},c),this.textOperation=function(e){u.setCommandMode(),e(),d.refreshPreview()}),(p=new o(r,c,u,g,h,s)).setUndoRedoButtonStates(),(d.refreshPreview=function(){g.refresh(!0)})()}}},e.prototype.findTags=function(e,t){var n,r=this;e&&(n=l.extendRegExp(e,"","$"),this.before=this.before.replace(n,function(e){return r.startTag=r.startTag+e,""}),n=l.extendRegExp(e,"^",""),this.selection=this.selection.replace(n,function(e){return r.startTag=r.startTag+e,""})),t&&(n=l.extendRegExp(t,"","$"),this.selection=this.selection.replace(n,function(e){return r.endTag=e+r.endTag,""}),n=l.extendRegExp(t,"^",""),this.after=this.after.replace(n,function(e){return r.endTag=e+r.endTag,""}))},e.prototype.trimWhitespace=function(e){var t,n,r=this;e?t=n="":(t=function(e){return r.before+=e,""},n=function(e){return r.after=e+r.after,""}),this.selection=this.selection.replace(/^(\s*)/,t).replace(/(\s*)$/,n)},e.prototype.skipLines=function(e,t,n){var r,i;if(e===undefined&&(e=1),t===undefined&&(t=1),e++,t++,navigator.userAgent.match(/Chrome/)&&"X".match(/()./),this.selection=this.selection.replace(/(^\n*)/,""),this.startTag=this.startTag+u.$1,this.selection=this.selection.replace(/(\n*$)/,""),this.endTag=this.endTag+u.$1,this.startTag=this.startTag.replace(/(^\n*)/,""),this.before=this.before+u.$1,this.endTag=this.endTag.replace(/(\n*$)/,""),this.after=this.after+u.$1,this.before){for(r=i="";e--;)r+="\\n?",i+="\n";n&&(r="\\n*"),this.before=this.before.replace(new u(r+"$",""),i)}if(this.after){for(r=i="";t--;)r+="\\n?",i+="\n";n&&(r="\\n*"),this.after=this.after.replace(new u(r,""),i)}},l.isVisible=function(e){return window.getComputedStyle?"none"!==window.getComputedStyle(e,null).getPropertyValue("display"):e.currentStyle?"none"!==e.currentStyle.display:void 0},l.addEvent=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},l.removeEvent=function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},l.fixEolChars=function(e){return e=(e=e.replace(/\r\n/g,"\n")).replace(/\r/g,"\n")},l.extendRegExp=function(e,t,n){null!==t&&t!==undefined||(t=""),null!==n&&n!==undefined||(n="");var r,i=e.toString();return i=(i=i.replace(/\/([gim]*)$/,function(e,t){return r=t,""})).replace(/(^\/|\/$)/g,""),new u(i=t+i+n,r)},c.getTop=function(e,t){var n=e.offsetTop;if(!t)for(;e=e.offsetParent;)n+=e.offsetTop;return n},c.getHeight=function(e){return e.offsetHeight||e.scrollHeight},c.getWidth=function(e){return e.offsetWidth||e.scrollWidth},c.getPageSize=function(){var e,t,n,r;return self.innerHeight&&self.scrollMaxY?(e=f.body.scrollWidth,t=self.innerHeight+self.scrollMaxY):f.body.scrollHeight>f.body.offsetHeight?(e=f.body.scrollWidth,t=f.body.scrollHeight):(e=f.body.offsetWidth,t=f.body.offsetHeight),self.innerHeight?(n=self.innerWidth,r=self.innerHeight):f.documentElement&&f.documentElement.clientHeight?(n=f.documentElement.clientWidth,r=f.documentElement.clientHeight):f.body&&(n=f.body.clientWidth,r=f.body.clientHeight),[Math.max(e,n),Math.max(t,r),n,r]},d.prompt=function(e,t,n,r,i){var o,a;n===undefined&&(n="");var s=function(e){27===(e.charCode||e.keyCode)&&c(!0)},c=function(e){l.removeEvent(f.body,"keydown",s);var t=a.value;return e?t=null:(t=t.replace(/^http:\/\/(https?|ftp):\/\//,"$1://"),/^(?:https?|ftp):\/\//.test(t)||(t="http://"+t)),$(o).modal("hide"),i(t),!1},d=function(){(o=f.createElement("div")).className="modal fade",o.style.display="none";var i=f.createElement("div");i.className="modal-dialog",o.appendChild(i);var d=f.createElement("div");d.className="modal-content",i.appendChild(d);var u=f.createElement("div");u.className="modal-header",u.innerHTML='<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> <h3 class="modal-title">'+e+"</h3>",d.appendChild(u);var p=f.createElement("div");p.className="modal-body",d.appendChild(p);var h=f.createElement("div");h.className="modal-footer",d.appendChild(h);var g=f.createElement("form");g.onsubmit=function(){return c(!1)},p.appendChild(g);var m=f.createElement("div");m.className="form-group",g.appendChild(m);var v=f.createElement("label");v.htmlFor="url-"+(new Date).getTime(),v.innerHTML=t,m.appendChild(v),(a=f.createElement("input")).id=v.htmlFor,a.type="text",a.className="form-control",a.placeholder=n,m.appendChild(a);var b=f.createElement("span");b.className="help-block",b.innerHTML=r||"",m.appendChild(b);var T=f.createElement("button");T.className="btn btn-primary",T.type="button",T.onclick=function(){return c(!1)},T.innerHTML="OK";var w=f.createElement("button");w.className="btn btn-default",w.type="button",w.onclick=function(){return c(!0)},w.innerHTML="Cancel",h.appendChild(T),h.appendChild(w),l.addEvent(f.body,"keydown",s),f.body.appendChild(o)};setTimeout(function(){d();var e=0;if(a.selectionStart!==undefined)a.selectionStart=0,a.selectionEnd=e;else if(a.createTextRange){var t=a.createTextRange();t.collapse(!1),t.moveStart("character",-e),t.moveEnd("character",e),t.select()}$(o).on("shown",function(){a.focus()}),$(o).on("hidden",function(){o.parentNode.removeChild(o)}),$(o).modal()},0)};var x=a.prototype;x.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)",x.unwrap=function(e){var t=new u("([^\\n])\\n(?!(\\n|"+this.prefixes+"))","g");e.selection=e.selection.replace(t,"$1 $2")},x.wrap=function(e,t){this.unwrap(e);var n=new u("(.{1,"+t+"})( +|$\\n?)","gm"),r=this;e.selection=e.selection.replace(n,function(e,t){return new u("^"+r.prefixes,"").test(e)?e:t+"\n"}),e.selection=e.selection.replace(/\s+$/,"")},x.doBold=function(e,t){return this.doBorI(e,t,2,"strong text")},x.doItalic=function(e,t){return this.doBorI(e,t,1,"emphasized text")},x.doBorI=function(e,t,n,r){e.trimWhitespace(),e.selection=e.selection.replace(/\n{2,}/g,"\n");var i=/(\**$)/.exec(e.before)[0],o=/(^\**)/.exec(e.after)[0],a=Math.min(i.length,o.length);if(a>=n&&(2!=a||1!=n))e.before=e.before.replace(u("[*]{"+n+"}$",""),""),e.after=e.after.replace(u("^[*]{"+n+"}",""),"");else if(!e.selection&&o){e.after=e.after.replace(/^([*_]*)/,""),e.before=e.before.replace(/(\s?)$/,"");var s=u.$1;e.before=e.before+o+s}else{e.selection||o||(e.selection=r);var l=n<=1?"*":"**";e.before=e.before+l,e.after=l+e.after}},x.stripLinkDefs=function(e,t){return e=e.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(e,n,r,i,o){return t[n]=e.replace(/\s*$/,""),i?(t[n]=e.replace(/["(](.+?)[")]$/,""),i+o):""})},x.addLinkDef=function(e,t){var n=0,r={};e.before=this.stripLinkDefs(e.before,r),e.selection=this.stripLinkDefs(e.selection,r),e.after=this.stripLinkDefs(e.after,r);var i="",o=/(\[)((?:\[[^\]]*\]|[^\[\]])*)(\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g,a=function(e){n++,e=e.replace(/^[ ]{0,3}\[(\d+)\]:/,"  ["+n+"]:"),i+="\n"+e},s=function(e,t,i,l,c,d){return i=i.replace(o,s),r[c]?(a(r[c]),t+i+l+n+d):e};e.before=e.before.replace(o,s),t?a(t):e.selection=e.selection.replace(o,s);var l=n;return e.after=e.after.replace(o,s),e.after&&(e.after=e.after.replace(/\n*$/,"")),e.after||(e.selection=e.selection.replace(/\n*$/,"")),e.after+="\n\n"+i,l},x.doLinkOrImage=function(e,t,n){if(e.trimWhitespace(),e.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/),!(e.endTag.length>1&&e.startTag.length>0)){if(e.selection=e.startTag+e.selection+e.endTag,e.startTag=e.endTag="",/\n\n/.test(e.selection))return void this.addLinkDef(e,null);var r=this,i=function(i){if(null!==i){e.selection=(" "+e.selection).replace(/([^\\](?:\\\\)*)(?=[[\]])/g,"$1\\").substr(1);var o=" [999]: "+s(i),a=r.addLinkDef(e,o);e.startTag=n?"![":"[",e.endTag="]["+a+"]",e.selection||(e.selection=n?"enter image description here":"enter link description here")}t()};return n?this.hooks.insertImageDialog(i)||d.prompt(w,C,k,E,i):d.prompt(m,v,b,T,i),!0}e.startTag=e.startTag.replace(/!?\[/,""),e.endTag="",this.addLinkDef(e,null)},x.doAutoindent=function(e){var t=this,n=!1;e.before=e.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n"),e.before=e.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n"),e.before=e.before.replace(/(\n|^)[ \t]+\n$/,"\n\n"),e.selection||/^[ \t]*(?:\n|$)/.test(e.after)||(e.after=e.after.replace(/^[^\n]*/,function(t){return e.selection=t,""}),n=!0),/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]+.*\n$/.test(e.before)&&t.doList&&t.doList(e),/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(e.before)&&t.doBlockquote&&t.doBlockquote(e),/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)&&t.doCode&&t.doCode(e),n&&(e.after=e.selection+e.after,e.selection="")},x.doBlockquote=function(e){e.selection=e.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(t,n,r,i){return e.before+=n,e.after=i+e.after,r}),e.before=e.before.replace(/(>[ \t]*)$/,function(t,n){return e.selection=n+e.selection,""}),e.selection=e.selection.replace(/^(\s|>)+$/,""),e.selection=e.selection||"Blockquote";var t,n="",r="";if(e.before){for(var i=e.before.replace(/\n$/,"").split("\n"),o=!1,a=0;a<i.length;a++){var s=!1;t=i[a],o=o&&t.length>0,/^>/.test(t)?(s=!0,!o&&t.length>1&&(o=!0)):s=!!/^[ \t]*$/.test(t)||o,s?n+=t+"\n":(r+=n+t,n="\n")}/(^|\n)>/.test(n)||(r+=n,n="")}e.startTag=n,e.before=r,e.after&&(e.after=e.after.replace(/^\n?/,"\n")),e.after=e.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(t){return e.endTag=t,""});var l=function(t){var n=t?"> ":"";e.startTag&&(e.startTag=e.startTag.replace(/\n((>|\s)*)\n$/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"})),e.endTag&&(e.endTag=e.endTag.replace(/^\n((>|\s)*)\n/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"}))};/^(?![ ]{0,3}>)/m.test(e.selection)?(this.wrap(e,h.lineLength-2),e.selection=e.selection.replace(/^/gm,"> "),l(!0),e.skipLines()):(e.selection=e.selection.replace(/^[ ]{0,3}> ?/gm,""),this.unwrap(e),l(!1),!/^(\n|^)[ ]{0,3}>/.test(e.selection)&&e.startTag&&(e.startTag=e.startTag.replace(/\n{0,2}$/,"\n\n")),!/(\n|^)[ ]{0,3}>.*$/.test(e.selection)&&e.endTag&&(e.endTag=e.endTag.replace(/^\n{0,2}/,"\n\n"))),e.selection=this.hooks.postBlockquoteCreation(e.selection),/\n/.test(e.selection)||(e.selection=e.selection.replace(/^(> *)/,function(t,n){return e.startTag+=n,""}))},x.doCode=function(e){var t=/\S[ ]*$/.test(e.before);if(!/^[ ]*\S/.test(e.after)&&!t||/\n/.test(e.selection)){e.before=e.before.replace(/[ ]{4}$/,function(t){return e.selection=t+e.selection,""});var n=1,r=1;/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)&&(n=0),/^\n(\t|[ ]{4,})/.test(e.after)&&(r=0),e.skipLines(n,r),e.selection?/^[ ]{0,3}\S/m.test(e.selection)?/\n/.test(e.selection)?e.selection=e.selection.replace(/^/gm,"    "):e.before+="    ":e.selection=e.selection.replace(/^[ ]{4}/gm,""):(e.startTag="    ",e.selection="enter code here")}else e.trimWhitespace(),e.findTags(/`/,/`/),e.startTag||e.endTag?e.endTag&&!e.startTag?(e.before+=e.endTag,e.endTag=""):e.startTag=e.endTag="":(e.startTag=e.endTag="`",e.selection||(e.selection="enter code here"))},x.doList=function(e,t,n){var r=/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,i=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/,o="-",a=1,s=function(){var e;return n?(e=" "+a+". ",a++):e=" "+o+" ",e},l=function(e){return n===undefined&&(n=/^\s*\d/.test(e)),e=e.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(){return s()})};if(e.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null),!e.before||/\n$/.test(e.before)||/^\n/.test(e.startTag)||(e.before+=e.startTag,e.startTag=""),e.startTag){var c=/\d+[.]/.test(e.startTag);if(e.startTag="",e.selection=e.selection.replace(/\n[ ]{4}/g,"\n"),this.unwrap(e),e.skipLines(),c&&(e.after=e.after.replace(i,l)),n==c)return}var d=1;e.before=e.before.replace(r,function(e){return/^\s*([*+-])/.test(e)&&(o=u.$1),d=/[^\n]\n\n[^\n]/.test(e)?1:0,l(e)}),e.selection||(e.selection="List item");var f=s(),p=1;e.after=e.after.replace(i,function(e){return p=/[^\n]\n\n[^\n]/.test(e)?1:0,l(e)}),e.trimWhitespace(!0),e.skipLines(d,p,!0),e.startTag=f;var g=f.replace(/./g," ");this.wrap(e,h.lineLength-g.length),e.selection=e.selection.replace(/\n/g,"\n"+g)},x.doHeading=function(e){if(e.selection=e.selection.replace(/\s+/g," "),e.selection=e.selection.replace(/(^\s+|\s+$)/g,""),!e.selection)return e.startTag="## ",e.selection="Heading",void(e.endTag="");var t=0;e.findTags(/#+[ ]*/,/[ ]*#+/),/#+/.test(e.startTag)&&(t=u.lastMatch.length),e.startTag=e.endTag="",e.findTags(null,/\s?(-+|=+)/),/=+/.test(e.endTag)&&(t=1),/-+/.test(e.endTag)&&(t=2),e.startTag=e.endTag="",e.skipLines(1,1);var n=0==t?2:t-1;if(n>0){var r=n>=2?"-":"=",i=e.selection.length;for(i>h.lineLength&&(i=h.lineLength),e.endTag="\n";i--;)e.endTag+=r}},x.doHorizontalRule=function(e){e.startTag="----------\n",e.selection="",e.skipLines(2,1,!0)}}();